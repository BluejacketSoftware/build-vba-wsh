<job id="bvba-create-dotm">
  <script language="JScript" src="..\lib\json2.js" />
  <script language="JScript" src="..\lib\bvba-util.js" />
  <script language="JScript" src="tiny-test.js" />
  <script language="JScript">
    //<![CDATA[
    var fso = new ActiveXObject("Scripting.FileSystemObject");

    test('Dependencies', function (assert) {
      {
        var msg = 'JSON is an object';

        var actual = typeof JSON;
        var expected = 'object';

        assert.same(actual, expected, msg);
      }
      {
        var msg = 'fso is an object';

        var actual = typeof fso;
        var expected = 'object';

        assert.same(actual, expected, msg);
      }
    });

    test('BVBA', function (assert) {
      {
        var msg = 'BVBA is an object';

        var actual = typeof BVBA;
        var expected = 'object';

        assert.same(actual, expected, msg);
      }

      {
        var pathScript = WScript.ScriptFullName;
        var f = fso.GetFile(pathScript);

        var msg = 'BVBA.getParentFolderName is the parent folder name';

        var actual = BVBA.getParentFolderName();
        var expected = fso.GetParentFolderName(f);

        assert.same(actual, expected, msg);
      }
    });

    //]]>
</script>
</job>